#!/usr/bin/env bash

COL_DEFAULT="\\[\033[39m\\]"

function promptCommand() {

    # add color to return value
    local statusColor=255
    local ret=$?
    if [ $ret -eq 0 ]; then
        statusColor=40 # green
    elif [ $ret -eq 69 ]; then
        statusColor=129 # purple ;)
    elif [ $ret -eq 147 ] || [ $ret -eq 148 ]; then
        statusColor=226 # yellow
    else
        statusColor=196 # red
    fi
    PS1_CMD1=$(echo -e "\033[38;5;${statusColor}m${ret}\033[39m")


    # git branch
    local branch="$(git branch --show-current 2>/dev/null)"
    if [ ${#branch} -gt 0 ]; then
        # wrap in yellow, underline
        PS1_CMD2=$(echo -e " \033[38;5;226m\033[4m${branch}\033[24m\033[39m")
    else
        PS1_CMD2="" # no display
    fi

}


PROMPT_COMMAND=promptCommand

PRE_PROMPT="\\[\033[0m\\]" # reset all modes
POST_PROMPT="\\[\033[5 q\\]" # cursor steady bar


TEAL_COLOR="\\[\033[38;5;49m\\]"
TIME="${TEAL_COLOR}\\t${COL_DEFAULT}"

PINK_COLOR="\\[\033[38;5;175m\\]"
USER_HOST="${PINK_COLOR}\\u@\\h${COL_DEFAULT}"

LIGHT_BLUE_COLOR="\\[\033[38;5;75m\\]"
WORK_DIR="${LIGHT_BLUE_COLOR}\\w${COL_DEFAULT}"

RET_VARIABLE='\[\033[38;5;40m\]Green\[\033[0m\]'


PS1="${PRE_PROMPT}┌[${TIME} ${USER_HOST} ${WORK_DIR} \${PS1_CMD1}\${PS1_CMD2}]\n└> ${POST_PROMPT}"
