#!/usr/bin/env bash

COL_DEFAULT="\\[\033[39m\\]"

function promptCommand() {

    # add color to return value
    local statusColor=255
    local ret=$?
    if [ $ret -eq 0 ]; then
        statusColor=40 # green
    elif [ $ret -eq 69 ]; then
        statusColor=129 # purple ;)
    elif [ $ret -eq 147 ] || [ $ret -eq 148 ]; then
        statusColor=226 # yellow
    else
        statusColor=196 # red
    fi
    PS1_CMD1="\\[\033[38;5;${statusColor}m\\]${ret}${COL_DEFAULT}"

    # git branch
    local branch="$(git branch --show-current 2>/dev/null)"
    if [ ${#branch} -gt 0 ]; then
        # wrap in yellow, underline
        PS1_CMD2=" \\[\033[38;5;226m\033[4m\\]${branch}\\[\033[24m\\]${COL_DEFAULT}"
    else
        PS1_CMD2="" # no display
    fi

}


PROMPT_COMMAND=promptCommand

PRE_PROMPT="\\[\033[0m\\]" # reset all modes
POST_PROMPT="\\[\033[5 q\\]" # cursor steady bar


TEAL_COLOR="\\[\033[38;5;49m\\]"
TIME="${TEAL_COLOR}\\t${COL_DEFAULT}"

PINK_COLOR="\\[\033[38;5;175m\\]"
USER_HOST="${PINK_COLOR}\\u@\\h${COLOR_DEFAULT}"

LIGHT_BLUE_COLOR="\\[\033[38;5;75m\\]"
WORK_DIR="${LIGHT_BLUE_COLOR}\\w${COLOR_DEFAULT}"


PS1="${PRE_PROMPT}┌[${TIME} ${USER_HOST} ${WORK_DIR} ${PS1_CMD1}${PS1_CMD2}]\n└> ${POST_PROMPT}"
